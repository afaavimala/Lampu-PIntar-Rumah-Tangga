<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ilustrasi End-to-End SmartLamp IoT</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%231f7f5c'/%3E%3Cpath d='M32 11c-7 7-11 14-11 21a11 11 0 0 0 22 0c0-7-4-14-11-21z' fill='%23fff7d8'/%3E%3Crect x='29' y='34' width='6' height='14' rx='3' fill='%2316304d'/%3E%3C/svg%3E" />
    <style>
      :root {
        --bg-1: #f5fbff;
        --bg-2: #e8f4ea;
        --text-main: #123149;
        --text-soft: #35566f;
        --client: #9cd4ff;
        --control: #9df0b5;
        --message: #ffd46b;
        --edge: #ff9f9f;
        --data: #cdb8ff;
        --cloud: #b7c7ff;
        --line-control: #1b5f93;
        --line-status: #1f7b59;
        --line-db: #8f5d22;
        --line-scheduler: #b64a1d;
        --line-cloud: #f38020;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Outfit", "Trebuchet MS", "Avenir Next", "Segoe UI", sans-serif;
        color: var(--text-main);
        background:
          radial-gradient(circle at 12% 14%, #ffffff 0%, transparent 35%),
          radial-gradient(circle at 90% 10%, #d7f2ff 0%, transparent 36%),
          radial-gradient(circle at 84% 88%, #d8fde5 0%, transparent 34%),
          linear-gradient(145deg, var(--bg-1), var(--bg-2));
      }

      .page {
        width: min(1220px, 94vw);
        margin: 0 auto;
        padding: 30px 0 42px;
      }

      .hero {
        margin-bottom: 16px;
      }

      .title {
        margin: 0 0 8px;
        font-size: clamp(1.5rem, 3.2vw, 2.35rem);
        letter-spacing: 0.4px;
      }

      .subtitle {
        margin: 0 0 14px;
        color: var(--text-soft);
        font-size: clamp(0.96rem, 1.65vw, 1.05rem);
        line-height: 1.45;
      }

      .beginner-note {
        border: 1px solid rgba(31, 91, 55, 0.24);
        background: linear-gradient(140deg, rgba(225, 255, 239, 0.9), rgba(242, 255, 248, 0.92));
        border-radius: 14px;
        padding: 10px 12px;
        margin: 0 0 12px;
        font-size: 0.86rem;
        color: #1f4f3c;
      }

      .beginner-note strong {
        color: #134734;
      }

      .starter-map {
        display: grid;
        grid-template-columns: repeat(3, minmax(180px, 1fr));
        gap: 10px;
        margin: 10px 0 12px;
      }

      .starter-item {
        border-radius: 14px;
        border: 1px solid rgba(22, 73, 108, 0.17);
        background: rgba(255, 255, 255, 0.82);
        padding: 10px 12px;
      }

      .starter-item h2 {
        margin: 0 0 4px;
        font-size: 0.94rem;
      }

      .starter-item p {
        margin: 0;
        font-size: 0.82rem;
        line-height: 1.42;
        color: var(--text-soft);
      }

      .simple-story {
        margin: 8px 0 14px;
        border-radius: 14px;
        border: 1px dashed rgba(20, 63, 95, 0.24);
        background: rgba(255, 255, 255, 0.75);
        padding: 10px 12px;
      }

      .simple-story h2 {
        margin: 0 0 6px;
        font-size: 0.92rem;
      }

      .simple-story ol {
        margin: 0;
        padding-left: 18px;
        color: var(--text-soft);
        font-size: 0.82rem;
        line-height: 1.45;
      }

      .simple-story li + li {
        margin-top: 2px;
      }

      .quick-guide {
        display: grid;
        grid-template-columns: repeat(3, minmax(180px, 1fr));
        gap: 10px;
        margin: 12px 0 14px;
      }

      .quick-line {
        display: grid;
        grid-template-columns: repeat(5, minmax(120px, 1fr));
        gap: 8px;
        margin: 10px 0 14px;
      }

      .super-map-wrap {
        margin: 10px 0 14px;
        border: 1px solid rgba(24, 70, 102, 0.22);
        border-radius: 14px;
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.92), rgba(235, 248, 255, 0.9));
        padding: 12px;
      }

      .super-map-wrap h2 {
        margin: 0 0 4px;
        font-size: 0.98rem;
      }

      .super-map-wrap p {
        margin: 0 0 10px;
        color: var(--text-soft);
        font-size: 0.82rem;
        line-height: 1.42;
      }

      .super-main {
        display: grid;
        grid-template-columns: 1.2fr 0.55fr 1.3fr 0.55fr 1.1fr 0.55fr 1.35fr 0.55fr 1.2fr;
        gap: 8px;
        align-items: center;
      }

      .super-return {
        margin-top: 10px;
        display: grid;
        grid-template-columns: 1.2fr 0.55fr 1.1fr 0.55fr 1.25fr 0.55fr 1.2fr;
        gap: 8px;
        align-items: center;
      }

      .super-node {
        border: 1px solid rgba(30, 75, 105, 0.18);
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.88);
        padding: 8px 9px;
        min-height: 78px;
        display: flex;
        gap: 8px;
      }

      .super-node h3 {
        margin: 0 0 2px;
        font-size: 0.82rem;
      }

      .super-node p {
        margin: 0;
        font-size: 0.76rem;
      }

      .heading-with-logo,
      .line-with-logo {
        display: flex;
        align-items: center;
        gap: 7px;
      }

      .heading-with-logo {
        flex-wrap: wrap;
        max-width: 100%;
        row-gap: 4px;
      }

      .line-with-logo {
        flex-wrap: wrap;
      }

      .logo-chip {
        width: 20px;
        min-width: 20px;
        height: 20px;
        border-radius: 6px;
        border: 1px solid rgba(22, 70, 99, 0.16);
        background: rgba(255, 255, 255, 0.92);
        padding: 2px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .logo-chip img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        display: block;
      }

      .logo-label {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        flex-wrap: wrap;
        min-width: 0;
        line-height: 1.35;
        vertical-align: middle;
      }

      .heading-with-logo .logo-chip:first-child {
        flex-shrink: 0;
      }

      .secondary-chip {
        width: 20px;
        min-width: 20px;
        height: 20px;
        border-radius: 6px;
        padding: 2px;
        margin-left: 0;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        vertical-align: middle;
        transform: none;
        flex-shrink: 0;
      }

      .super-node.client {
        background: color-mix(in srgb, var(--client) 60%, #ffffff 40%);
      }

      .super-node.control {
        background: color-mix(in srgb, var(--control) 62%, #ffffff 38%);
      }

      .super-node.message {
        background: color-mix(in srgb, var(--message) 64%, #ffffff 36%);
      }

      .super-node.edge {
        background: color-mix(in srgb, var(--edge) 62%, #ffffff 38%);
      }

      .super-icon {
        width: 24px;
        min-width: 24px;
        height: 24px;
        border-radius: 999px;
        background: #1d6a9c;
        color: #ffffff;
        display: grid;
        place-items: center;
        font-size: 0.72rem;
        font-weight: 700;
        margin-top: 1px;
      }

      .super-arrow {
        position: relative;
        height: 8px;
        border-radius: 999px;
        background: color-mix(in srgb, #1b5f93 30%, #ffffff 70%);
        color: #1b5f93;
      }

      .super-arrow::after {
        content: "";
        position: absolute;
        right: -8px;
        top: 50%;
        transform: translateY(-50%);
        border-left: 8px solid currentColor;
        border-top: 5px solid transparent;
        border-bottom: 5px solid transparent;
      }

      .super-arrow .tag {
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid rgba(24, 69, 100, 0.18);
        border-radius: 999px;
        padding: 1px 7px;
        color: #1f4b68;
        font-size: 0.72rem;
        font-weight: 700;
        white-space: nowrap;
      }

      .memory-aid {
        margin-top: 10px;
        border-radius: 10px;
        border: 1px dashed rgba(24, 69, 100, 0.28);
        background: rgba(255, 255, 255, 0.85);
        padding: 8px 9px;
        font-size: 0.78rem;
        color: #264d68;
      }

      .memory-aid strong {
        color: #173f5b;
      }

      .quick-step {
        border-radius: 12px;
        border: 1px solid rgba(27, 74, 106, 0.16);
        background: rgba(255, 255, 255, 0.82);
        padding: 8px 10px;
        text-align: center;
      }

      .quick-step .num {
        display: inline-block;
        min-width: 22px;
        border-radius: 999px;
        background: #1e6ca2;
        color: #ffffff;
        font-size: 0.74rem;
        font-weight: 700;
        padding: 3px 7px;
        margin-bottom: 5px;
      }

      .quick-step p {
        margin: 0;
        font-size: 0.8rem;
        color: var(--text-soft);
        line-height: 1.35;
      }

      .quick-step .line-with-logo {
        justify-content: center;
      }

      .guide-item {
        border-radius: 14px;
        border: 1px solid rgba(27, 74, 106, 0.14);
        background: rgba(255, 255, 255, 0.76);
        padding: 10px 12px;
      }

      .guide-item h2 {
        margin: 0 0 5px;
        font-size: 0.96rem;
      }

      .guide-item p {
        margin: 0;
        font-size: 0.84rem;
        color: var(--text-soft);
        line-height: 1.42;
      }

      .legend-grid {
        display: grid;
        grid-template-columns: repeat(5, minmax(130px, 1fr));
        gap: 8px;
        margin-top: 10px;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 10px;
        border-radius: 10px;
        border: 1px solid rgba(20, 63, 95, 0.14);
        padding: 8px 10px;
        font-size: 0.79rem;
        color: #2a4f6d;
        background: rgba(255, 255, 255, 0.78);
      }

      .legend-item strong {
        display: block;
        color: #173d58;
      }

      .legend-item span {
        display: block;
      }

      .legend-swatch {
        width: 18px;
        min-width: 18px;
        height: 18px;
        border-radius: 5px;
        border: 1px solid rgba(19, 55, 81, 0.24);
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.35);
      }

      .legend-client {
        background: var(--client);
      }

      .legend-control {
        background: var(--control);
      }

      .legend-message {
        background: var(--message);
      }

      .legend-edge {
        background: var(--edge);
      }

      .legend-cloud {
        background: var(--cloud);
      }

      .brand-row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 12px;
      }

      .brand-pill {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 10px;
        border: 1px solid rgba(20, 63, 95, 0.16);
        background: rgba(255, 255, 255, 0.78);
        border-radius: 999px;
        color: #2a4f6d;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .brand-pill img {
        width: 16px;
        height: 16px;
        display: block;
      }

      .term-grid {
        display: grid;
        grid-template-columns: repeat(4, minmax(150px, 1fr));
        gap: 10px;
        margin-top: 12px;
      }

      .term-card {
        border-radius: 12px;
        border: 1px solid rgba(29, 73, 103, 0.17);
        background: rgba(255, 255, 255, 0.78);
        padding: 9px 10px;
      }

      .term-card h3 {
        margin: 0 0 4px;
        font-size: 0.84rem;
      }

      .term-card p {
        margin: 0;
        font-size: 0.78rem;
        color: var(--text-soft);
        line-height: 1.38;
      }

      .flow-wrap {
        border: 1px solid rgba(35, 76, 110, 0.2);
        border-radius: 18px;
        background: linear-gradient(155deg, #f9fdff, #eef9ff 45%, #effef4);
        box-shadow: 0 14px 30px rgba(26, 70, 102, 0.12);
        padding: 16px;
      }

      .panel-title {
        margin: 0 0 6px;
        font-size: 1.05rem;
      }

      .panel-sub {
        margin: 0 0 14px;
        color: var(--text-soft);
        font-size: 0.9rem;
      }

      .mode-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 14px;
        margin-top: 12px;
        min-width: 0;
      }

      .mode-panel {
        --node-col: minmax(112px, 1fr);
        --connector-col: clamp(64px, 4.8vw, 88px);
        --snake-cols: var(--node-col) var(--connector-col) var(--node-col) var(--connector-col) var(--node-col) var(--connector-col) var(--node-col) var(--connector-col) var(--node-col);
        --feedback-cols: var(--node-col) var(--connector-col) var(--node-col) var(--connector-col) var(--node-col) var(--connector-col) var(--node-col);
        border: 1px solid rgba(35, 76, 110, 0.24);
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.82);
        padding: 8px;
        width: 100%;
        min-width: 0;
        box-sizing: border-box;
        overflow: hidden;
      }

      .mode-panel.local {
        box-shadow: inset 0 0 0 1px rgba(31, 91, 147, 0.1);
      }

      .mode-panel.cloud {
        box-shadow: inset 0 0 0 1px rgba(243, 128, 32, 0.14);
      }

      .mode-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }

      .mode-head h3 {
        margin: 0;
        font-size: 1rem;
      }

      .mode-badge {
        border-radius: 999px;
        border: 1px solid rgba(24, 68, 98, 0.2);
        background: rgba(255, 255, 255, 0.88);
        padding: 3px 9px;
        font-size: 0.73rem;
        font-weight: 700;
        color: #214a67;
        white-space: nowrap;
      }

      .mode-desc {
        margin: 4px 0 6px;
        font-size: 0.8rem;
        line-height: 1.35;
        color: var(--text-soft);
      }

      .flow-track {
        width: 100%;
        min-width: 0;
        overflow: visible;
        padding-top: 10px;
        padding-bottom: 0;
      }

      .mode-panel .main-flow,
      .mode-panel .snake-turn-row {
        width: 100%;
        display: grid;
        grid-template-columns: var(--snake-cols);
        gap: 3px;
        align-items: stretch;
      }

      .mode-panel .feedback-flow {
        width: 100%;
        display: grid;
        grid-template-columns: var(--feedback-cols);
        gap: 3px;
        align-items: stretch;
      }

      .main-flow .connector,
      .feedback-flow .connector {
        align-self: center;
      }

      .snake-turn-row {
        padding: 0;
      }

      .mode-support {
        margin-top: 6px;
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 6px;
      }

      .mode-mini {
        min-height: 56px;
      }

      .mode-mini h3 {
        margin: 0 0 4px;
        font-size: 0.88rem;
      }

      .mode-mini p {
        margin: 0;
        font-size: 0.76rem;
        line-height: 1.34;
        color: var(--text-soft);
      }

      .compare-table-wrap {
        margin-top: 12px;
        border: 1px solid rgba(28, 71, 101, 0.18);
        border-radius: 14px;
        overflow-x: auto;
        background: rgba(255, 255, 255, 0.86);
      }

      .compare-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 760px;
      }

      .compare-table th,
      .compare-table td {
        border-bottom: 1px solid rgba(27, 73, 104, 0.14);
        border-right: 1px solid rgba(27, 73, 104, 0.14);
        padding: 8px 10px;
        text-align: left;
        vertical-align: top;
        font-size: 0.79rem;
        line-height: 1.4;
      }

      .compare-table th:last-child,
      .compare-table td:last-child {
        border-right: none;
      }

      .compare-table thead th {
        background: color-mix(in srgb, var(--cloud) 30%, #ffffff 70%);
        color: #173f5b;
        font-size: 0.78rem;
        text-transform: uppercase;
        letter-spacing: 0.3px;
      }

      .compare-table tbody tr:last-child td {
        border-bottom: none;
      }

      .main-flow {
        gap: 3px;
      }

      .feedback-flow {
        margin-top: 0;
        gap: 3px;
      }

      .feedback-flow > :nth-child(1) { grid-column: 7; grid-row: 1; }
      .feedback-flow > :nth-child(2) { grid-column: 6; grid-row: 1; }
      .feedback-flow > :nth-child(3) { grid-column: 5; grid-row: 1; }
      .feedback-flow > :nth-child(4) { grid-column: 4; grid-row: 1; }
      .feedback-flow > :nth-child(5) { grid-column: 3; grid-row: 1; }
      .feedback-flow > :nth-child(6) { grid-column: 2; grid-row: 1; }
      .feedback-flow > :nth-child(7) { grid-column: 1; grid-row: 1; }

      .snake-turn-row .connector.turn {
        grid-column: 9;
        width: 10px;
        min-width: 10px;
        height: 32px;
        margin: 0 auto;
      }

      .snake-turn-row .connector.turn::after {
        right: auto;
        left: 50%;
        top: auto;
        bottom: -8px;
        transform: translateX(-50%);
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-top: 9px solid currentColor;
        border-bottom: none;
      }

      .snake-turn-row .connector.turn .tag {
        top: -4px;
        left: 50%;
        transform: translate(-50%, -100%);
      }

      .snake-turn-row .connector.turn .packet {
        left: 50%;
        top: 2px;
        transform: translateX(-50%);
        animation-name: move-down;
      }

      .node {
        border-radius: 14px;
        border: 1px solid rgba(29, 73, 103, 0.18);
        background: rgba(255, 255, 255, 0.8);
        padding: 7px 8px;
        min-height: 68px;
      }

      .node.client {
        background: color-mix(in srgb, var(--client) 88%, #ffffff 12%);
        border-color: color-mix(in srgb, var(--client) 64%, #194365 36%);
      }

      .node.control {
        background: color-mix(in srgb, var(--control) 88%, #ffffff 12%);
        border-color: color-mix(in srgb, var(--control) 62%, #1f5d3f 38%);
      }

      .node.message {
        background: color-mix(in srgb, var(--message) 88%, #ffffff 12%);
        border-color: color-mix(in srgb, var(--message) 60%, #5e4312 40%);
      }

      .node.edge {
        background: color-mix(in srgb, var(--edge) 88%, #ffffff 12%);
        border-color: color-mix(in srgb, var(--edge) 62%, #642025 38%);
      }

      .node.data {
        background: color-mix(in srgb, var(--data) 88%, #ffffff 12%);
        border-color: color-mix(in srgb, var(--data) 62%, #302062 38%);
      }

      .node.cloud {
        background: color-mix(in srgb, var(--cloud) 88%, #ffffff 12%);
        border-color: color-mix(in srgb, var(--cloud) 62%, #1e2f68 38%);
      }

      .node h3 {
        margin: 0 0 4px;
        font-size: 0.91rem;
        line-height: 1.2;
      }

      .node p {
        margin: 0;
        font-size: 0.75rem;
        color: var(--text-soft);
        line-height: 1.3;
      }

      .heading-with-logo.dual-logo {
        display: grid;
        grid-template-columns: auto auto;
        justify-content: start;
        align-items: center;
        column-gap: 6px;
        row-gap: 3px;
      }

      .heading-with-logo.dual-logo .logo-chip:first-child {
        grid-column: 1;
        grid-row: 1;
      }

      .heading-with-logo.dual-logo .secondary-chip {
        grid-column: 2;
        grid-row: 1;
      }

      .heading-with-logo.dual-logo .logo-label {
        grid-column: 1 / span 2;
        grid-row: 2;
        margin-top: 1px;
      }

      .connector {
        position: relative;
        height: 10px;
        min-width: 0;
        width: 100%;
        border-radius: 999px;
        overflow: visible;
      }

      .connector::after {
        content: "";
        position: absolute;
        right: -8px;
        top: 50%;
        transform: translateY(-50%);
        border-left: 9px solid currentColor;
        border-top: 6px solid transparent;
        border-bottom: 6px solid transparent;
      }

      .connector.back::after {
        right: auto;
        left: -8px;
        border-left: none;
        border-right: 9px solid currentColor;
      }

      .c-control {
        background: color-mix(in srgb, var(--line-control) 35%, #ffffff 65%);
        color: var(--line-control);
      }

      .c-command {
        background: color-mix(in srgb, var(--line-control) 35%, #ffffff 65%);
        color: var(--line-control);
      }

      .c-status {
        background: color-mix(in srgb, var(--line-status) 40%, #ffffff 60%);
        color: var(--line-status);
      }

      .c-action {
        background: color-mix(in srgb, var(--line-scheduler) 45%, #ffffff 55%);
        color: var(--line-scheduler);
      }

      .c-cloud {
        background: color-mix(in srgb, var(--line-cloud) 45%, #ffffff 55%);
        color: var(--line-cloud);
      }

      .connector .tag {
        position: absolute;
        top: -5px;
        bottom: auto;
        left: 50%;
        transform: translate(-50%, -100%);
        width: max-content;
        background: rgba(255, 255, 255, 0.92);
        border: 1px solid rgba(20, 63, 95, 0.14);
        border-radius: 999px;
        padding: 2px 7px;
        font-size: 0.66rem;
        font-weight: 700;
        color: #1e4560;
        letter-spacing: 0.12px;
        white-space: nowrap;
        text-align: center;
        line-height: 1.1;
        pointer-events: none;
        z-index: 5;
        box-shadow: 0 1px 2px rgba(13, 41, 63, 0.14);
      }

      .packet {
        position: absolute;
        width: 11px;
        height: 11px;
        border-radius: 999px;
        top: 50%;
        transform: translateY(-50%);
        left: 2px;
        background: currentColor;
        animation: move-right 2.4s linear infinite;
      }

      .connector.back .packet {
        left: auto;
        right: 2px;
        animation-name: move-left;
      }

      .helper-grid {
        margin-top: 14px;
        display: grid;
        grid-template-columns: 1.2fr 1.2fr 1fr;
        gap: 10px;
      }

      .cloud-flow {
        margin-top: 12px;
        display: grid;
        grid-template-columns: 1.2fr 0.65fr 1.6fr 0.65fr 1.2fr 0.65fr 1.35fr;
        gap: 8px;
        align-items: center;
      }

      .cloud-notes {
        margin-top: 10px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }

      .helper-card {
        border: 1px solid rgba(33, 75, 108, 0.18);
        border-radius: 14px;
        background: rgba(255, 255, 255, 0.78);
        padding: 10px 12px;
      }

      .helper-card h3 {
        margin: 0 0 6px;
        font-size: 0.95rem;
      }

      .helper-card p {
        margin: 0;
        color: var(--text-soft);
        font-size: 0.84rem;
        line-height: 1.45;
      }

      .helper-card ul {
        margin: 0;
        padding-left: 18px;
        color: var(--text-soft);
        font-size: 0.84rem;
        line-height: 1.45;
      }

      .steps {
        margin-top: 16px;
        display: grid;
        grid-template-columns: repeat(3, minmax(190px, 1fr));
        gap: 10px;
      }

      .role-wrap {
        margin-top: 16px;
        display: grid;
        grid-template-columns: repeat(6, minmax(150px, 1fr));
        gap: 10px;
      }

      .role-item {
        border: 1px solid rgba(30, 74, 104, 0.17);
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.76);
        padding: 10px;
      }

      .role-item h3 {
        margin: 0 0 4px;
        font-size: 0.88rem;
      }

      .role-item p {
        margin: 0;
        font-size: 0.8rem;
        line-height: 1.4;
        color: var(--text-soft);
      }

      .step {
        border: 1px solid rgba(37, 79, 111, 0.16);
        background: rgba(255, 255, 255, 0.76);
        border-radius: 14px;
        padding: 12px;
      }

      .step h3 {
        margin: 0 0 6px;
        font-size: 0.95rem;
      }

      .step p {
        margin: 0;
        color: var(--text-soft);
        font-size: 0.86rem;
        line-height: 1.45;
      }

      @keyframes move-right {
        from { left: 2px; }
        to { left: calc(100% - 13px); }
      }

      @keyframes move-left {
        from { right: 2px; }
        to { right: calc(100% - 13px); }
      }

      .hero,
      .flow-wrap,
      .role-wrap,
      .steps {
        animation: rise-in 0.62s ease both;
      }

      .flow-wrap { animation-delay: 0.08s; }
      .role-wrap { animation-delay: 0.15s; }
      .steps { animation-delay: 0.22s; }

      @keyframes rise-in {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .hero,
        .flow-wrap,
        .role-wrap,
        .steps,
        .packet {
          animation: none !important;
        }
      }

      @media (max-width: 980px) {
        .starter-map,
        .quick-guide {
          grid-template-columns: 1fr;
        }

        .super-main,
        .super-return {
          grid-template-columns: 1fr;
        }

        .super-node {
          min-height: 74px;
        }

        .super-arrow {
          width: 8px;
          height: 46px;
          margin: 0 auto;
        }

        .super-arrow::after {
          right: auto;
          left: 50%;
          top: auto;
          bottom: -8px;
          transform: translateX(-50%);
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-top: 8px solid currentColor;
          border-bottom: none;
        }

        .super-arrow .tag {
          top: 50%;
          left: 16px;
          transform: translateY(-50%);
        }

        .quick-line {
          grid-template-columns: 1fr 1fr;
        }

        .term-grid {
          grid-template-columns: 1fr 1fr;
        }

        .legend-grid {
          grid-template-columns: 1fr 1fr;
        }

        .main-flow {
          grid-template-columns: 1fr;
          gap: 34px;
        }

        .feedback-flow {
          grid-template-columns: 1fr;
          gap: 34px;
        }

        .feedback-flow > * {
          grid-column: auto !important;
        }

        .snake-turn-row {
          display: none;
        }

        .mode-grid {
          grid-template-columns: 1fr;
        }

        .mode-support {
          grid-template-columns: 1fr;
        }

        .cloud-flow {
          grid-template-columns: 1fr;
          gap: 10px;
        }

        .connector {
          width: 10px;
          height: 64px;
          margin: 2px auto;
        }

        .connector::after {
          right: auto;
          left: 50%;
          top: auto;
          bottom: -8px;
          transform: translateX(-50%);
          border-left: 6px solid transparent;
          border-right: 6px solid transparent;
          border-top: 9px solid currentColor;
          border-bottom: none;
        }

        .connector.back::after {
          left: 50%;
          top: -8px;
          bottom: auto;
          border-right: 6px solid transparent;
          border-left: 6px solid transparent;
          border-bottom: 9px solid currentColor;
        }

        .feedback-flow .connector.back::after {
          top: auto;
          bottom: -8px;
          border-right: 6px solid transparent;
          border-left: 6px solid transparent;
          border-top: 9px solid currentColor;
          border-bottom: none;
        }

        .connector .tag {
          top: -4px;
          bottom: auto;
          left: 50%;
          transform: translate(-50%, -100%);
          white-space: nowrap;
        }

        .packet {
          left: 50%;
          top: 2px;
          transform: translateX(-50%);
          animation-name: move-down;
        }

        .connector.back .packet {
          right: auto;
          left: 50%;
          top: auto;
          bottom: 2px;
          transform: translateX(-50%);
          animation-name: move-up;
        }

        .feedback-flow .connector.back .packet {
          top: 2px;
          bottom: auto;
          animation-name: move-down;
        }

        .helper-grid {
          grid-template-columns: 1fr;
        }

        .cloud-notes {
          grid-template-columns: 1fr;
        }

        .steps {
          grid-template-columns: repeat(2, minmax(150px, 1fr));
        }

        .role-wrap {
          grid-template-columns: 1fr 1fr;
        }
      }

      @media (max-width: 680px) {
        .page {
          width: min(1240px, 96vw);
          padding-top: 20px;
        }

        .quick-line {
          grid-template-columns: 1fr;
        }

        .term-grid {
          grid-template-columns: 1fr;
        }

        .steps {
          grid-template-columns: 1fr;
        }

        .legend-grid,
        .role-wrap {
          grid-template-columns: 1fr;
        }
      }

      @keyframes move-down {
        from { top: 2px; }
        to { top: calc(100% - 13px); }
      }

      @keyframes move-up {
        from { bottom: 2px; }
        to { bottom: calc(100% - 13px); }
      }
    </style>
  </head>
  <body>
    <main class="page">
      <header class="hero">
        <h1 class="title">Ilustrasi End-to-End Ekosistem SmartLamp IoT</h1>
        <p class="subtitle">
          Diagram ini menampilkan alur detail end-to-end: kontrol ON/OFF, jalur MQTT command + status/LWT, stream SSE realtime,
          serta alur scheduler dan penyimpanan data untuk mode Node lokal maupun Worker.
        </p>
        <section class="legend-grid" aria-label="Legenda warna komponen">
          <article class="legend-item">
            <span class="legend-swatch legend-client" aria-hidden="true"></span>
            <div><strong>User/Dashboard</strong><span>Area UI pengguna</span></div>
          </article>
          <article class="legend-item">
            <span class="legend-swatch legend-control" aria-hidden="true"></span>
            <div><strong>Backend/Kontrol</strong><span>Area validasi dan orkestrasi</span></div>
          </article>
          <article class="legend-item">
            <span class="legend-swatch legend-message" aria-hidden="true"></span>
            <div><strong>HiveMQ Broker/Pesan</strong><span>Area publish-subscribe command + status/LWT MQTT</span></div>
          </article>
          <article class="legend-item">
            <span class="legend-swatch legend-edge" aria-hidden="true"></span>
            <div><strong>Device/Lampu Fisik</strong><span>Area eksekusi perangkat</span></div>
          </article>
          <article class="legend-item">
            <span class="legend-swatch legend-cloud" aria-hidden="true"></span>
            <div><strong>Cloudflare Worker (Mode Cloud)</strong><span>Runtime API + MQTT realtime stream + D1</span></div>
          </article>
        </section>
        <div class="brand-row" aria-label="Teknologi utama">
          <span class="brand-pill"><img src="./assets/icons/react.svg" alt="" />React</span>
          <span class="brand-pill"><img src="./assets/icons/nodejs.svg" alt="" />Node.js</span>
          <span class="brand-pill"><img src="./assets/icons/cloudflare.svg" alt="" />Cloudflare</span>
          <span class="brand-pill"><img src="./assets/icons/hivemq.svg" alt="" />HiveMQ</span>
          <span class="brand-pill"><img src="./assets/icons/mariadb.svg" alt="" />MariaDB</span>
          <span class="brand-pill"><img src="./assets/icons/espressif.svg" alt="" />Espressif</span>
          <span class="brand-pill"><img src="./assets/icons/arduino.svg" alt="" />Arduino</span>
        </div>
        <section class="term-grid" aria-label="Kamus istilah untuk awam">
          <article class="term-card" data-logo="dashboard">
            <h3>HTTP/HTTPS</h3>
            <p>Jalur kirim permintaan dari browser ke backend (mirip saat buka website).</p>
          </article>
          <article class="term-card" data-logo="broker">
            <h3>MQTT</h3>
            <p>Jalur pesan ringan IoT untuk command dan status/lwt antara ESP32, broker, dan backend.</p>
          </article>
          <article class="term-card" data-logo="status">
            <h3>SSE</h3>
            <p>Aliran status satu arah dari backend ke browser setelah backend menerima event dari broker MQTT.</p>
          </article>
          <article class="term-card" data-logo="backend">
            <h3>ACL + Idempotency</h3>
            <p>Perintah dipublish oleh backend setelah validasi akses device dan kontrol replay request API.</p>
          </article>
        </section>
      </header>

      <section class="flow-wrap" aria-label="Diagram animatif end-to-end SmartLamp">
        <h2 class="panel-title">Blok Diagram End-to-End (Mode Lokal vs Mode Cloud)</h2>
        <p class="panel-sub">Urutan blok dan alur protokol sama untuk lokal/cloud. Bedanya ada di runtime backend, storage, dan trigger scheduler.</p>

        <div class="mode-grid">
          <article class="mode-panel local" data-logo="backend">
            <div class="mode-head">
              <h3>Mode Lokal: Node.js + MariaDB</h3>
              <span class="mode-badge">Local Server / On-Prem</span>
            </div>
            <p class="mode-desc">Command dari UI diproses backend, lewat broker ke device, lalu status/LWT kembali ke UI via SSE.</p>

            <div class="flow-track">
              <div class="main-flow">
                <article class="node client" data-logo="dashboard">
                  <h3>1. Dashboard Web</h3>
                  <p>Klik ON/OFF.</p>
                </article>
                <div class="connector c-control"><span class="tag">HTTPS</span><span class="packet"></span></div>

                <article class="node control" data-logo="backend">
                  <h3>2. Hono API (Node.js)</h3>
                  <p>Validasi akses + publish command.</p>
                </article>
                <div class="connector c-command"><span class="tag">MQTT WSS</span><span class="packet"></span></div>

                <article class="node message" data-logo="broker">
                  <h3>3. HiveMQ Broker</h3>
                  <p>Terima command, route ke device.</p>
                </article>
                <div class="connector c-command"><span class="tag">MQTT TLS</span><span class="packet"></span></div>

                <article class="node edge" data-logo="esp32" data-logo-secondary="arduino">
                  <h3>4. ESP32 / Tasmota</h3>
                  <p>Validasi payload, lalu eksekusi relay.</p>
                </article>
                <div class="connector c-action"><span class="tag">GPIO</span><span class="packet"></span></div>

                <article class="node edge" data-logo="lamp">
                  <h3>5. Relay Lampu</h3>
                  <p>Lampu berubah ON/OFF.</p>
                </article>
              </div>
            </div>

            <div class="snake-turn-row" aria-hidden="true">
              <div class="connector c-status turn"><span class="tag">Status/LWT</span><span class="packet"></span></div>
            </div>

            <div class="flow-track">
              <div class="feedback-flow">
                <article class="node edge" data-logo="esp32" data-logo-secondary="arduino">
                  <h3>6. Device Publish Status/LWT</h3>
                  <p>Kirim status/LWT retained ke broker.</p>
                </article>
                <div class="connector c-status back"><span class="tag">MQTT pub</span><span class="packet"></span></div>

                <article class="node message" data-logo="broker">
                  <h3>7. HiveMQ Retain + Fan-out</h3>
                  <p>Simpan retained, lalu fan-out.</p>
                </article>
                <div class="connector c-status back"><span class="tag">MQTT sub</span><span class="packet"></span></div>

                <article class="node control" data-logo="status">
                  <h3>8. Realtime Proxy Node + SSE</h3>
                  <p>Subscribe MQTT, push SSE ke browser.</p>
                </article>
                <div class="connector c-status back"><span class="tag">SSE</span><span class="packet"></span></div>

                <article class="node client" data-logo="dashboard">
                  <h3>9. Dashboard Auto-Update</h3>
                  <p>UI update realtime tanpa reload.</p>
                </article>
              </div>
            </div>

            <div class="mode-support">
              <article class="helper-card node control mode-mini" data-logo="scheduler">
                <h3>Scheduler Lokal</h3>
                <p>Timer lokal jalan sesuai jadwal.</p>
              </article>
              <article class="helper-card node data mode-mini" data-logo="database">
                <h3>Storage Lokal</h3>
                <p>Session, device, jadwal, log di MariaDB.</p>
              </article>
            </div>
          </article>

          <article class="mode-panel cloud" data-logo="cloudflare">
            <div class="mode-head">
              <h3>Mode Cloud: Cloudflare Worker + D1</h3>
              <span class="mode-badge">Single URL App + API</span>
            </div>
            <p class="mode-desc">Alur sama; runtime backend di Worker dan penyimpanan data di D1.</p>

            <div class="flow-track">
              <div class="main-flow">
                <article class="node client" data-logo="dashboard">
                  <h3>1. Dashboard Web</h3>
                  <p>Klik ON/OFF.</p>
                </article>
                <div class="connector c-control"><span class="tag">HTTPS</span><span class="packet"></span></div>

                <article class="node cloud" data-logo="cloudflare">
                  <h3>2. Hono API (Cloudflare Worker)</h3>
                  <p>Validasi akses + publish command.</p>
                </article>
                <div class="connector c-cloud"><span class="tag">MQTT WSS</span><span class="packet"></span></div>

                <article class="node message" data-logo="broker">
                  <h3>3. HiveMQ Broker</h3>
                  <p>Terima command, route ke device.</p>
                </article>
                <div class="connector c-command"><span class="tag">MQTT TLS</span><span class="packet"></span></div>

                <article class="node edge" data-logo="esp32" data-logo-secondary="arduino">
                  <h3>4. ESP32 / Tasmota</h3>
                  <p>Validasi payload, lalu eksekusi relay.</p>
                </article>
                <div class="connector c-action"><span class="tag">GPIO</span><span class="packet"></span></div>

                <article class="node edge" data-logo="lamp">
                  <h3>5. Relay Lampu</h3>
                  <p>Lampu berubah ON/OFF.</p>
                </article>
              </div>
            </div>

            <div class="snake-turn-row" aria-hidden="true">
              <div class="connector c-status turn"><span class="tag">Status/LWT</span><span class="packet"></span></div>
            </div>

            <div class="flow-track">
              <div class="feedback-flow">
                <article class="node edge" data-logo="esp32" data-logo-secondary="arduino">
                  <h3>6. Device Publish Status/LWT</h3>
                  <p>Kirim status/LWT retained ke broker.</p>
                </article>
                <div class="connector c-status back"><span class="tag">MQTT pub</span><span class="packet"></span></div>

                <article class="node message" data-logo="broker">
                  <h3>7. HiveMQ Retain + Fan-out</h3>
                  <p>Simpan retained, lalu fan-out.</p>
                </article>
                <div class="connector c-status back"><span class="tag">MQTT sub</span><span class="packet"></span></div>

                <article class="node cloud" data-logo="status">
                  <h3>8. Worker MQTT Subscribe + SSE</h3>
                  <p>Subscribe MQTT per stream, push SSE.</p>
                </article>
                <div class="connector c-status back"><span class="tag">SSE</span><span class="packet"></span></div>

                <article class="node client" data-logo="dashboard">
                  <h3>9. Dashboard Auto-Update</h3>
                  <p>UI update realtime tanpa reload.</p>
                </article>
              </div>
            </div>

            <div class="mode-support">
              <article class="helper-card node cloud mode-mini" data-logo="scheduler">
                <h3>Scheduler Cloud</h3>
                <p>Cron trigger jalan sesuai jadwal.</p>
              </article>
              <article class="helper-card node data mode-mini" data-logo="database">
                <h3>Storage Cloud</h3>
                <p>Session, device, jadwal, log di D1.</p>
              </article>
            </div>
          </article>
        </div>

        <h2 class="panel-title" style="margin-top: 14px;">Perbandingan Komponen & Protokol</h2>
        <p class="panel-sub">Tabel ini merangkum per tahap agar mode lokal dan cloud bisa dibandingkan langsung baris-per-baris.</p>
        <div class="compare-table-wrap">
          <table class="compare-table" aria-label="Perbandingan mode lokal dan cloud">
            <thead>
              <tr>
                <th>Tahap</th>
                <th>Mode Lokal (Node.js)</th>
                <th>Mode Cloud (Worker)</th>
                <th>Protokol</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Runtime API + Auth</td>
                <td>Hono API di Node.js, ditambah realtime proxy process-wide.</td>
                <td>Hono API di Cloudflare Worker + Durable Object MQTT gateway.</td>
                <td>HTTPS</td>
              </tr>
              <tr>
                <td>Publish Command</td>
                <td>Publish `cmnd/{id}/POWER` ke HiveMQ (persistent connection).</td>
                <td>Publish `cmnd/{id}/POWER` via Durable Object ke HiveMQ (persistent connection).</td>
                <td>MQTT over WSS (`:8884/mqtt`)</td>
              </tr>
              <tr>
                <td>Delivery ke Device</td>
                <td>HiveMQ kirim command ke ESP32/Tasmota dan device eksekusi relay.</td>
                <td>HiveMQ kirim command ke ESP32/Tasmota dan device eksekusi relay.</td>
                <td>MQTT TLS (`:8883`) + GPIO</td>
              </tr>
              <tr>
                <td>Realtime Status/LWT</td>
                <td>Proxy Node subscribe status/lwt lalu stream SSE ke dashboard.</td>
                <td>Worker subscribe status/lwt per stream SSE lalu kirim ke dashboard.</td>
                <td>MQTT subscribe + SSE</td>
              </tr>
              <tr>
                <td>Penyimpanan Data</td>
                <td>MariaDB untuk session, device, schedule, dan command log.</td>
                <td>Cloudflare D1 untuk session, device, schedule, dan command log.</td>
                <td>SQL / D1 Binding</td>
              </tr>
              <tr>
                <td>Scheduler</td>
                <td>`setInterval` memicu `runDueSchedules()`.</td>
                <td>Cron Trigger Worker memicu `runDueSchedules()`.</td>
                <td>Internal runtime scheduler</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="role-wrap" aria-label="Peran komponen utama">
        <article class="role-item" data-logo="user">
          <h3>User</h3>
          <p>Memberi perintah ON/OFF atau membuat jadwal dari dashboard.</p>
        </article>
        <article class="role-item" data-logo="dashboard">
          <h3>Dashboard</h3>
          <p>Mengirim perintah ke backend dan menampilkan status realtime.</p>
        </article>
        <article class="role-item" data-logo="backend">
          <h3>Backend</h3>
          <p>Memastikan akses valid, menandatangani command, dan meneruskan data status.</p>
        </article>
        <article class="role-item" data-logo="cloudflare">
          <h3>Cloudflare Worker</h3>
          <p>Runtime mode cloud (posisi di langkah 2 dan 8): API, MQTT realtime, serta binding ke D1.</p>
        </article>
        <article class="role-item" data-logo="broker">
          <h3>HiveMQ Broker</h3>
          <p>Jalur publish-subscribe command + status/LWT antara backend dan ESP32/Tasmota.</p>
        </article>
        <article class="role-item" data-logo="esp32" data-logo-secondary="arduino">
          <h3>Arduino/ESP32 + Relay</h3>
          <p>Menjalankan aksi fisik lampu lalu melaporkan hasilnya.</p>
        </article>
      </section>

      <section class="steps" aria-label="Tahapan detail alur end-to-end">
        <article class="step" data-logo="user">
          <h3>1. User klik ON/OFF di dashboard</h3>
          <p>Browser mengirim request API ke backend dengan session login.</p>
        </article>
        <article class="step" data-logo="backend">
          <h3>2. Runtime backend validasi + publish command</h3>
          <p>Node.js lokal atau Cloudflare Worker (mode cloud) cek akses device, lalu publish command ke HiveMQ.</p>
        </article>
        <article class="step" data-logo="broker">
          <h3>3. HiveMQ kirim command ke ESP32/Tasmota</h3>
          <p>Device menerima payload pada topic command sesuai device ID/topic profile.</p>
        </article>
        <article class="step" data-logo="esp32" data-logo-secondary="arduino">
          <h3>4. Device eksekusi command</h3>
          <p>ESP32/Tasmota menjalankan POWER sesuai payload yang diterima.</p>
        </article>
        <article class="step" data-logo="lamp">
          <h3>5. Relay lampu dieksekusi</h3>
          <p>Jika valid, lampu dihidupkan/dimatikan lalu device publish status terbaru.</p>
        </article>
        <article class="step" data-logo="status">
          <h3>6. Status realtime kembali ke dashboard</h3>
          <p>Backend (proxy Node atau Worker per-stream) menerima status/LWT dari HiveMQ lalu meneruskannya via SSE tanpa reload.</p>
        </article>
      </section>
    </main>
    <script>
      (() => {
        const logoMap = {
          user: "./assets/icons/user.svg",
          dashboard: "./assets/icons/react.svg",
          backend: "./assets/icons/nodejs.svg",
          arduino: "./assets/icons/arduino.svg",
          cloudflare: "./assets/icons/cloudflare.svg",
          broker: "./assets/icons/hivemq.svg",
          esp32: "./assets/icons/espressif.svg",
          lamp: "./assets/icons/lamp.svg",
          status: "./assets/icons/stream.svg",
          scheduler: "./assets/icons/schedule.svg",
          database: "./assets/icons/mariadb.svg",
          reconnect: "./assets/icons/cloudflare.svg",
          guide: "./assets/icons/guide.svg"
        };

        const attachLogos = () => {
          document.querySelectorAll("[data-logo]").forEach((block) => {
            const logoKey = block.getAttribute("data-logo");
            const logoSrc = logoMap[logoKey];
            const secondaryKey = block.getAttribute("data-logo-secondary");
            const secondarySrc = secondaryKey ? logoMap[secondaryKey] : null;
            if (!logoSrc) {
              return;
            }

            const target = block.querySelector("h2, h3, p");
            if (!target || target.querySelector(".logo-chip")) {
              return;
            }

            const chip = document.createElement("span");
            chip.className = "logo-chip";

            const img = document.createElement("img");
            img.src = logoSrc;
            img.alt = "";
            chip.appendChild(img);

            if (target.tagName === "P") {
              target.classList.add("line-with-logo");
            } else {
              target.classList.add("heading-with-logo");
            }
            const textLabel = target.textContent.trim();
            target.textContent = "";
            target.appendChild(chip);

            const textSpan = document.createElement("span");
            textSpan.className = "logo-label";
            textSpan.textContent = textLabel;
            target.appendChild(textSpan);

            if (secondarySrc) {
              const secondChip = document.createElement("span");
              secondChip.className = "logo-chip secondary-chip";
              const secondImg = document.createElement("img");
              secondImg.src = secondarySrc;
              secondImg.alt = "";
              secondChip.appendChild(secondImg);
              target.appendChild(secondChip);
              if (target.tagName !== "P") {
                target.classList.add("dual-logo");
              }
            }
          });
        };

        attachLogos();
      })();
    </script>
  </body>
</html>
